<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.1" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>Gotw1 - Hexo</title>


    <meta name="description" content="C++ 有多少种初始化变量的方法四种：  默认初始化 直接初始化 拷贝初始化 列表初始化  说下下面各行代码的含义123456789widget w;                   &#x2F;&#x2F; (a)widget w();                 &#x2F;&#x2F; (b)widget w{};                 &#x2F;&#x2F; (c)widget w(x);                &#x2F;&#x2F; (">
<meta property="og:type" content="article">
<meta property="og:title" content="Gotw1">
<meta property="og:url" content="http://yoursite.com/2021/11/21/Gotw1/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="C++ 有多少种初始化变量的方法四种：  默认初始化 直接初始化 拷贝初始化 列表初始化  说下下面各行代码的含义123456789widget w;                   &#x2F;&#x2F; (a)widget w();                 &#x2F;&#x2F; (b)widget w{};                 &#x2F;&#x2F; (c)widget w(x);                &#x2F;&#x2F; (">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://yoursite.com/images/og_image.png">
<meta property="article:published_time" content="2021-11-21T13:29:07.000Z">
<meta property="article:modified_time" content="2021-11-23T14:52:43.561Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="C++">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/images/og_image.png">







<link rel="icon" href="/images/ylj.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/css/style.css">



</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.jpg" alt="Gotw1" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="https://github.com/zzpzbl">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-9-widescreen has-order-2 column-main">
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2021-11-21T13:29:07.000Z">2021-11-21</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/C/">C++</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 minutes read (About 1015 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                Gotw1
            
        </h1>
        <div class="content">
            <html><head></head><body><h2 id="C-有多少种初始化变量的方法"><a href="#C-有多少种初始化变量的方法" class="headerlink" title="C++ 有多少种初始化变量的方法"></a>C++ 有多少种初始化变量的方法</h2><p>四种：</p>
<ul>
<li>默认初始化</li>
<li>直接初始化</li>
<li>拷贝初始化</li>
<li>列表初始化</li>
</ul>
<h2 id="说下下面各行代码的含义"><a href="#说下下面各行代码的含义" class="headerlink" title="说下下面各行代码的含义"></a>说下下面各行代码的含义</h2><figure class="highlight cpp hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">widget w;                   <span class="hljs-comment">// (a)</span></span><br><span class="line"><span class="hljs-function">widget <span class="hljs-title">w</span><span class="hljs-params">()</span></span>;                 <span class="hljs-comment">// (b)</span></span><br><span class="line">widget w{};                 <span class="hljs-comment">// (c)</span></span><br><span class="line"><span class="hljs-function">widget <span class="hljs-title">w</span><span class="hljs-params">(x)</span></span>;                <span class="hljs-comment">// (d)</span></span><br><span class="line">widget w{x};                <span class="hljs-comment">// (e)</span></span><br><span class="line">widget w = x;               <span class="hljs-comment">// (f)</span></span><br><span class="line">widget w = {x};             <span class="hljs-comment">// (g)</span></span><br><span class="line"><span class="hljs-keyword">auto</span> w = x;                 <span class="hljs-comment">// (h)</span></span><br><span class="line"><span class="hljs-keyword">auto</span> w = widget{x};         <span class="hljs-comment">// (i)</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>(a)</code> 是默认初始化，调用的是 <code>default constructor widget::widget()</code><br><code>(b)</code> 是个陷阱，不是变量初始化，而是一个名为 <code>w</code> 返回 <code>widget</code> 类型且不接受参数的函数的声明，令人讨厌的事，这种形式很有可能形成歧义，例如下面的代码：</p>
<figure class="highlight cpp hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// same problem (gadget and doodad are types)</span></span><br><span class="line"><span class="hljs-comment">//</span></span><br><span class="line"><span class="hljs-function">widget <span class="hljs-title">w</span><span class="hljs-params">( gadget(), doodad() )</span></span>;  <span class="hljs-comment">// pitfall: not a variable declaration</span></span><br></pre></td></tr></tbody></table></figure>
<p>好消息是 <code>C++11</code> 解决了这个问题，通过提供一种几乎在所有情况下都取代 <code>case (b)</code> 的语法来解决这个问题，这样我们就不必再陷入这个坑了，答案就是 <code>case (c)</code><br><code>(c)</code> 是一种非常好的写法，它总是初始化变量，并且永远不会与函数声明产生歧义。<br><code>(d)</code> 和 <code>(e)</code> 都是直接初始化（假设 <code>x</code> 不是类型名）。二者都是通过 <code>widget::widget(x)</code>。如果 <code>x</code> 是 <code>widget</code> 类型，则调用拷贝构造函数，否则，将调用转换构造函数，注意到 <code>(e)</code> 创建了一个 <code>std::initializer_list</code>。如果 <code>widget</code> 有一个带 <code>initializer_list</code> 的构造函数，那么这个构造函数是首选； 否则，如果 <code>widget</code> 具有接受任何类型 <code>x</code> 的构造函数（可能带有转换），则使用该构造函数。<br>使用 <code>(e)</code> 有以下几个好处（相较于 <code>(d)</code>）：</p>
<ul>
<li>避免了歧义，因为 <code>(e)</code> 永远不可能是是一个函数声明</li>
<li>更安全，因为 <code>(e)</code> 不允许有损转换</li>
</ul>
<figure class="highlight cpp hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">i1</span><span class="hljs-params">( <span class="hljs-number">12.345</span> )</span></span>;           <span class="hljs-comment">// ok: toss .345, we didn't like it anyway</span></span><br><span class="line"><span class="hljs-keyword">int</span> i2{ <span class="hljs-number">12.345</span> };           <span class="hljs-comment">// error: would be lossy implicit narrowing</span></span><br></pre></td></tr></tbody></table></figure>
<p><code>(f)</code> 和 <code>(g)</code> 分别是复制初始化和复制列表初始化<br>在 <code>(f)</code> 中，从概念上来讲，<code>w</code> 应该是通过拷贝构造函数或者移动构造函数初始化的，但必须纠正的一点是，不是出现的 <code>=</code> 就意味着调用的 <code>T::operator=</code>，它仍然是属于初始化而不是赋值。如果 <code>x</code> 是 <code>widget</code> 类型的，那么 <code>(f)</code> 和 <code>(d)</code> 是一样的，调用 <code>widget::widget(x);</code>（除了 <code>explicit ctor</code> 被调用）；如果 <code>x</code> 是其它类型，从概念上讲，编译器首先将 <code>x</code> 隐式转换为临时 <code>widget</code> 对象，然后从该临时右值移动构造 <code>w</code>，如果没有更好的移动构造函数，则使用复制构造作为“移动的缓慢方式”作为备份可用。假设隐式转换可用，<code>(f)</code> 的意思与 <code>widget w(widget(x));</code> 相同。<br><code>(g)</code> 被称之为 <code>copy-list-initialization</code>，含义和 <code>widget w{x}</code> 相同，但注意，<code>copy-list-initialization</code> 不会调用 <code>explicit ctor</code>，只有普通的构造函数才能被调用<br><code>(h)</code> 和 <code>(i)</code> 都是复制初始化，他们的语义和 <code>(f)</code> 和 <code>(g)</code> 相似，但更加简单，因为 <code>auto</code> 保证了右手表达式的类型将被准确推导出<br>Line (h) means the same as (d), type_of_x w(x);. Only a single copy constructor is called. This is guaranteed to stay true as the program evolves: Because line (h) does not commit to an explicit type, it is guaranteed to be both maximally efficient because there can be no conversion involved, and maximally robust under maintenance as the type of w “auto”-matically tracks the type of x which may change as the program is maintained.</p>
<p>Line (i) is the most consistent spelling when you do want to commit to a specific type and explicitly request a conversion if needed, and once again the { } syntax happily avoids lossy narrowing conversions. In practice on most compilers, only a single constructor is called—similarly to what we saw with (f) and (g), conceptually there are two constructor calls, a converting or copy constructor to create a temporary widget{x} followed by a move to move it to w, but compilers routinely elide the latter.</p>
<p>这两段话来自 <a href="https://herbsutter.com/2013/05/09/gotw-1-solution/，翻译起来很累。。。" target="_blank" rel="noopener">https://herbsutter.com/2013/05/09/gotw-1-solution/，翻译起来很累。。。</a></p>
</body></html>
        </div>
        
        <hr style="height:1px;margin:1rem 0"/>
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <i class="fas fa-tags has-text-grey"></i>&nbsp;
                    <a class="has-link-grey -link" href="/tags/C/" rel="tag">C++</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2021/02/10/Redis%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%EF%BC%9Amap/">
                <span class="level-item">Redis数据类型：map</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">Comments</h3>
        
<div id="valine-thread" class="content"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script>
    new Valine({
        el: '#valine-thread' ,
        notify: true,
        verify: false,
        app_id: '7TfDPJyT4b1VUUumeHmk9tkI-gzGzoHsz',
        app_key: 'rwxzbTHEWoV96C547pa3dM3V',
        placeholder: '舒服了'
    });
</script>

    </div>
</div>

</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="" src="/images/avatar.jpg" alt="lengpi">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        lengpi
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        student
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Shanghai, China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <p class="title has-text-weight-normal">
                        18
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <p class="title has-text-weight-normal">
                        9
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <p class="title has-text-weight-normal">
                        8
                    </p>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/zzpzbl" target="_blank">
                Follow</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Github" href="https://github.com/zzpzbl">
                
                <i class="fab fa-github"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
<div class="card widget column-left is-sticky" id="toc">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Catalogue
            </h3>
            <ul class="menu-list"><li>
        <a class="is-flex" href="#C-有多少种初始化变量的方法">
        <span class="has-mr-6">1</span>
        <span>C++ 有多少种初始化变量的方法</span>
        </a></li><li>
        <a class="is-flex" href="#说下下面各行代码的含义">
        <span class="has-mr-6">2</span>
        <span>说下下面各行代码的含义</span>
        </a></li></ul>
        </div>
    </div>
</div>

    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
        </div>
    
</div>


                

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.jpg" alt="Gotw1" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2021 John Doe&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="https://github.com/zzpzbl">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>

<script>
var IcarusThemeSettings = {
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>



    
    
<script src="/js/animation.js"></script>

    
    
<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>

    
    
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/" target="_blank" rel="noopener">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>

    
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>
    
    
<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>

    
    
    
    
    
    
    
    
    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>
